package com.spacecombat;

public class HealthController extends Component {
	public int health;

	@Override
	public void collide(final Collision collision) {
		if (!collision.getWhatIHit().hasTag(collision.getMe().getTags())) {
			final ShotCollision sc = (ShotCollision) collision.getWhatIHit()
					.getComponent(ShotCollision.class);

			if (sc != null) {
				System.out.println(collision.getMe().getName() + " took "
						+ sc.getDamage() + " hp: " + this.health);
				this.health -= sc.getDamage();
			} else {
				System.out.println("Something wrong, what I hit:"
						+ collision.getWhatIHit().getName());
			}

			final GraphicAnimation animation = this.gameObject
					.getCurrentAnimation();

			if (this.health <= 0 && !(animation.getName().equals("death"))) {
				final GraphicAnimation death = this.gameObject
						.playAnimation("death");
				this.gameObject.destroyAfter((long) death.getDuration());

				this.gameObject.removeComponent(AIScript.class);
			}
		}
	}

	public void setHealth(final int health) {
		this.health = health;
	}
}
